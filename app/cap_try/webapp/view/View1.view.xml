<mvc:View controllerName="cap_try.controller.View1"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:table="sap.ui.table"
    xmlns:l="sap.ui.layout"
	xmlns:f="sap.ui.layout.form"
    xmlns:core="sap.ui.core"
    xmlns="sap.m">
    
    <Page id="page" title="{i18n>title}">
            <customHeader>
                <Bar>
                    <contentLeft>
                        <Button icon="sap-icon://menu2" press="menu" />
                    </contentLeft>
                    <contentMiddle>
                        <Title text="{i18n>shop}" />
                    </contentMiddle>
                    <contentRight>
                        <Button icon="sap-icon://cart" press="openCartDialog" tooltip="{i18n>cart}" >
                            <customData>
                                <BadgeCustomData animation="Update"  value="{= ${globalModel>/cart}.length }" />
                            </customData>
                        </Button>
                    </contentRight>
                </Bar>
            </customHeader>
            <Panel expandable="true"
                width="auto"
                   class="sapUiResponsiveMargin"
                   expanded="true"
                   headerText="Toggle Company Details">
                <VBox>
                    <f:SimpleForm id="SimpleFormDisplay354"
                        editable="false"
                        layout="ResponsiveGridLayout"
                        title="Company details"
                        labelSpanXL="3"
                        labelSpanL="3"
                        labelSpanM="3"
                        labelSpanS="12"
                        adjustLabelSpan="false"
                        emptySpanXL="4"
                        emptySpanL="4"
                        emptySpanM="4"
                        emptySpanS="0"
                        columnsXL="1"
                        columnsL="1"
                        columnsM="1"
                        binding="{globalModel>/selectedCompany}" >
                        <f:content>
                            <Label class="sapUiTinyMargin" text="Company name" />
                            <HBox width="auto">
                                <ComboBox width="auto" change="onCompanyChange" value="{globalModel>name}" id="companyComboBox" placeholder="Select a company..."
                                items="{ path: '/Company',
                                         sorter: { path: 'name' } }">
                                    <items>
                                        <core:Item key="{ID}" text="{name}" />
                                    </items>
                                </ComboBox>  
                                <Button text="{i18n>cancel}" type="Default" class="sapUiSmallMarginBegin" 
                                        visible="{= !!${globalModel>name} }" press="onCompanyCancelPress" />
                            </HBox>              
                            <Label text="Name" />
                            <Text text="{globalModel>name}" />
                            <Label text="Description" />
                            <Text text="{globalModel>description}" />
                            <Label text="Capital" />
                            <Text id="countryText" text="{globalModel>capital} {globalModel>currency}" />
                        </f:content>
                    </f:SimpleForm>
                </VBox>
            </Panel>
            <content>
                <HBox width="auto">
                    <VBox class="sapUiResponsiveMargin">
                    <Title text="Lista de Produtos" level="H3" />
                        <table:Table
                            id="productsWorklist"
                            rows="{globalModel>/products}"
                            selectionMode="MultiToggle"
                            enableColumnReordering="true"
                            enableColumnFreeze="true"
                            alternateRowColors="true">
                            <table:extension>
                                <OverflowToolbar>
                                        <OverflowToolbarButton icon="sap-icon://add" text="{i18n>addProduct}" press="addProductCart" />
                                    <ToolbarSpacer />
                                    <ToolbarSpacer />
                                        <Title level="H2" text="Total" titleStyle="Auto" width="" wrapping="false" wrappingType="Normal" />
                                        <Text text="{= ${globalModel>/products}.length }" />
                                </OverflowToolbar>
                            </table:extension>
                            <table:rowSettingsTemplate>
                            <table:RowSettings highlight="{= ${globalModel>status} === 'Error' ? 'Error' : ${globalModel>status} === 'Warning' ? 'Warning' : 'Success'}"
                                               tooltip="{= ${globalModel>status} === 'Error' ? 'Error: Low stock' : ${globalModel>status} === 'Warning' ? 'Warning: Medium stock' : 'Success: In stock'}"/>
                            </table:rowSettingsTemplate>
                            <table:columns>
                                <table:Column width="4rem" hAlign="Center">
                                    <Label text="{i18n>status}" />
                                    <table:template>
                                        <core:Icon src="{= ${globalModel>status} === 'Error' ? 'sap-icon://error' : ${globalModel>status} === 'Warning' ? 'sap-icon://alert' : 'sap-icon://sys-enter-2'}"
                                                   tooltip="{= ${globalModel>status} === 'Error' ? 'Low stock' : ${globalModel>status} === 'Warning' ? 'Medium stock' : 'In stock'}" />
                                    </table:template>
                                </table:Column>
                                <!-- <table:Column width="3rem" hAlign="Center">
                                    <Label text="{i18n>id}" />
                                    <table:template>
                                        <Text text="{globalModel>ID}" />
                                    </table:template>
                                </table:Column> -->
                                <table:Column width="4rem" hAlign="Center">
                                    <Label text="{i18n>edit}" />
                                    <table:template>
                                        <!-- <core:Icon src="sap-icon://edit" press="onIconPress" /> -->
                                        <Button
                                            icon="sap-icon://edit"
                                            type="Transparent"
                                            tooltip="Edit Product"
                                            press="onEditProductPress" />
                                    </table:template>
                                </table:Column>
                                <table:Column width="4rem" hAlign="Center">
                                    <Label text="{i18n>delete}" />
                                    <table:template>
                                        <!-- <core:Icon src="sap-icon://edit" press="onIconPress" /> -->
                                        <Button
                                            icon="sap-icon://delete"
                                            type="Transparent"
                                            tooltip="Delete Product"
                                            press="onDeleteProductPress" />
                                    </table:template>
                                </table:Column>
                                <table:Column autoResizable="true">
                                    <Label text="{i18n>name}" />
                                    <table:template>
                                        <Text text="{globalModel>name}" />
                                    </table:template>
                                </table:Column>
                                <table:Column autoResizable="true">
                                    <Label text="{i18n>description}" />
                                    <table:template>
                                        <Text text="{globalModel>description}" />
                                    </table:template>
                                </table:Column>
                                <table:Column width="7rem">
                                    <Label text="{i18n>price}" />
                                    <table:template>
                                        <Text text="{ path: 'globalModel>price', formatter: '.priceDecimalCasesFormatter' }" />
                                        <!-- <Text text="{globalModel>price} {globalModel>/selectedCompany/currency}" /> -->
                                    </table:template>
                                </table:Column>
                                <table:Column width="7rem">
                                    <Label text="{i18n>stock_min}" />
                                    <table:template>
                                        <Text text="{globalModel>stock_min}" />
                                    </table:template>
                                </table:Column>
                                <table:Column width="7rem">
                                    <Label text="{i18n>stock_max}" />
                                    <table:template>
                                        <Text text="{globalModel>stock_max}" />
                                    </table:template>
                                </table:Column>
                                <table:Column width="10rem">
                                    <Label text="{i18n>quantity}" />
                                    <table:template>
                                        <Input type="Number" change="onQuantityInputChange" value="{globalModel>quantity}" />
                                    </table:template>
                                </table:Column>
                            </table:columns>
                        </table:Table>
                    </VBox>
                </HBox>
            </content>
            <footer>
                <Toolbar>
                    <Button visible="{= ${messageModel>/}.length !== 0}" press="toggleMessageView" icon="sap-icon://alert" text="{= ${messageModel>/}.length}" />
                    <ToolbarSpacer />
                    <Button press="openAddProductDialog" icon="sap-icon://add-product"/>
                </Toolbar>
            </footer>
    </Page>
</mvc:View>